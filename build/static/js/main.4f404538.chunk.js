(this["webpackJsonpchat-app-client"]=this["webpackJsonpchat-app-client"]||[]).push([[0],{118:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(19),o=a.n(l),i=(a(76),a(77),a(5)),c=a(7),s=a(10),m=a.n(s),u=a(13),d=a(18),p=a(16),f=a(22),g=a(26),E=a(28),h=a(126),b=a(121),y=a(127),v=a(66),w=a(122),j=a(123);var O=function(e){var t=new g.GiphyFetch("tivenjqL1A6W3LpKpPZ4StawMGFAcjdD"),a=(Object(f.f)(),function(e){var t=document.getElementById("post-"+e+"-select");"emoji"===e?document.getElementById("post-gif-select").style.display="none":document.getElementById("post-emoji-select").style.display="none","block"===t.style.display?t.style.display="none":t.style.display="block"}),n=function(){var a=Object(u.a)(m.a.mark((function a(n,r){var l,o;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r.preventDefault(),document.getElementById("post-img-div").style.display="none",document.getElementById("post-gif-div").style.display="block",a.next=5,t.gif(n.id);case 5:return l=a.sent,o=l.data,a.next=9,e.setFormData({"post-text":e.formData["post-text"],"gif-id":o.images.preview_webp.url});case 9:e.setGif(o);case 10:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(h.a,Object.assign({show:e.ShowCreatePostOrComment,onHide:e.handleCloseCreatePostOrComment},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),r.a.createElement(h.a.Header,{closeButton:!0},r.a.createElement(h.a.Title,null,"comment"===e.type?"Write a Comment":"Create Post")),r.a.createElement(h.a.Body,null,r.a.createElement(b.a,{variant:"danger",style:{display:"none"},id:"post-alert"}),r.a.createElement("div",{id:"post-profile-div"},r.a.createElement("img",{src:localStorage.getItem("imageUri"),alt:"profile"}),"\u2003",r.a.createElement("span",null,r.a.createElement("strong",null,localStorage.getItem("f_name")+" "+localStorage.getItem("l_name")))),r.a.createElement(y.a,{onChange:function(t){var a=t.target.name,n=t.target.value;"post-img"===t.target.name?e.setFormData(Object(p.a)({},e.formData,Object(d.a)({},a,t.target.files[0]))):e.setFormData(Object(p.a)({},e.formData,Object(d.a)({},a,n)))},onSubmit:function(t){t.preventDefault(),document.getElementById("post-spinner").style.display="inline-block";var a=new FormData;a.append("post-text",e.formData["post-text"]),a.append("post-gif",e.formData["gif-id"]),a.append("image",e.formData["post-img"]),"comment"===e.type&&a.append("postId",e.postId);var n="comment"===e.type?"/users/profile/post/comment":"commentOnComment"===e.type?"/users/profile/post/commentOnComment":"/users/profile/post/",r=new Headers;r.append("Authorization","Bearer "+localStorage.getItem("token")),fetch(n,{method:"Post",body:a,headers:r}).then((function(e){return e.json()})).then((function(t){if("success"===t.saved){var a=document.getElementById("post-alert");a.className="fade alert alert-success show",a.style.display="block",a.innerHTML="Your details had been saved...",setTimeout((function(){e.handleCloseCreatePostOrComment()}),2e3)}else document.getElementById("post-spinner").style.display="none",function(e){var t=document.getElementById("post-alert");if(t.style.display="block",e.error&&(t.innerHTML+=e.error.msg),e.errors){var a=1;e.errors.map((function(e){t.innerHTML+="<p>"+a+". "+e.msg+"<br/></p>",a++}))}setTimeout((function(){t.style.display="none"}),1e4)}(t)}))}},r.a.createElement(v.a,null,r.a.createElement(y.a.Control,{plaintext:!0,as:"textarea",rows:"3",placeholder:"comment"===e.type?"Type your comment here...":"What's on your mind "+localStorage.getItem("f_name"),name:"post-text",id:"post-text",required:!0})),r.a.createElement(v.a,null,r.a.createElement(y.a.File,{id:"post-pic-upload",custom:!0,style:{display:"none"}},r.a.createElement(y.a.File.Input,{name:"post-img",onChange:function(e){var t=e.target.files[0],a=document.getElementById("post-alert");if("image/jpeg"!==t.type&&"image/png"!==t.type)a.style.display="block",a.innerHTML="Only .jpeg or .png files allowed...",e.target.value="";else{var n=new FileReader;n.onload=function(e){document.getElementById("post-img-show").src=e.target.result},n.readAsDataURL(t),document.getElementById("post-gif-div").style.display="none",document.getElementById("post-img-div").style.display="block"}}}))),r.a.createElement("div",{id:"post-img-div"},r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons",onClick:function(){document.getElementById("post-pic-upload").value="",document.getElementById("post-img-div").style.display="none",e.setFormData({"post-text":e.formData["post-text"]})}}," ","remove_circle"),r.a.createElement("img",{src:"#",alt:"",id:"post-img-show"}))),r.a.createElement("div",{id:"post-gif-div"},e.gif&&r.a.createElement(E.Gif,{gif:e.gif,width:window.matchMedia("(max-width: 480px)").matches?150:200,hideAttribution:!0}),r.a.createElement("i",{className:"material-icons",onClick:function(){e.setGif(null),e.setFormData({"post-text":e.formData["post-text"]}),document.getElementById("post-gif-div").style.display="none"}}," ","remove_circle")),r.a.createElement(w.a,{variant:"primary",type:"submit",id:"post-button",style:{width:"100%"}},r.a.createElement("strong",null,e.type||"Post"),"\u2003",r.a.createElement(j.a,{animation:"border",variant:"dark",size:"sm",id:"post-spinner",style:{display:"none"}})))),r.a.createElement(h.a.Footer,{id:"post-footer"},r.a.createElement("strong",{style:{justifySelf:"left"}},"Add to your ",e.type||"post"),r.a.createElement(w.a,{variant:"light"},r.a.createElement("i",{className:"material-icons",onClick:function(){return document.getElementById("post-pic-upload").click()}},"image")),r.a.createElement(w.a,{variant:"light"}," ",r.a.createElement("i",{className:"material-icons",onClick:function(){return a("gif")}},"gif")),r.a.createElement(w.a,{variant:"light",onClick:function(){return a("emoji")}},r.a.createElement("span",null,"\ud83d\ude04")," "),r.a.createElement("div",{id:"post-emoji-select"}," ",r.a.createElement(E.Grid,{width:window.matchMedia("(max-width: 480px)").matches?250:450,columns:window.matchMedia("(max-width: 480px)").matches?2:3,fetchGifs:function(e){return t.emoji({offset:e,limit:10})},hideAttribution:!0,onGifClick:function(e,t){return n(e,t)}})),r.a.createElement("div",{id:"post-gif-select"}," ",r.a.createElement(E.Grid,{width:window.matchMedia("(max-width: 480px)").matches?250:450,columns:window.matchMedia("(max-width: 480px)").matches?2:3,fetchGifs:function(e){return t.trending({offset:e,limit:10})},hideAttribution:!0,onGifClick:function(e,t){return n(e,t)}})))))};var S=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),l=a[0],o=a[1],s=function(){return o(!0)},m=Object(n.useState)(null),u=Object(i.a)(m,2),d=u[0],p=u[1],f=Object(n.useState)({}),g=Object(i.a)(f,2),E=g[0],h=g[1];return r.a.createElement("div",null,r.a.createElement("ul",{id:"side-nav-phone"},r.a.createElement(c.b,{to:"/user/"},r.a.createElement("li",null,r.a.createElement("i",{class:"material-icons"},"store"))),r.a.createElement(c.b,{to:"/user/explore"},r.a.createElement("li",null,r.a.createElement("i",{class:"material-icons"},"explore"))),r.a.createElement(c.b,{to:"/user/notifications"},r.a.createElement("li",null,r.a.createElement("i",{class:"material-icons"},"notifications"))),r.a.createElement(c.b,{to:"/user/messages"},r.a.createElement("li",null,r.a.createElement("i",{class:"material-icons"},"message")))),r.a.createElement("button",{id:"tweet-button-phone",onClick:s},r.a.createElement("i",{class:"material-icons"}," edit")),r.a.createElement("ul",{id:"side-nav"},r.a.createElement(c.b,{to:"/user/"},r.a.createElement("li",null,r.a.createElement("h2",null,"InstaChat"))),r.a.createElement(c.b,{to:"/user/"},r.a.createElement("li",null,r.a.createElement("i",{class:"material-icons"},"store"),"\u2003Home")),r.a.createElement(c.b,{to:"/user/explore"},r.a.createElement("li",null,r.a.createElement("i",{class:"material-icons"},"explore"),"\u2003Explore")),r.a.createElement(c.b,{to:"/user/notifications"},r.a.createElement("li",null,r.a.createElement("i",{class:"material-icons"},"notifications"),"\u2003Notifications")),r.a.createElement(c.b,{to:"/user/messages"},r.a.createElement("li",null,r.a.createElement("i",{class:"material-icons"},"message"),"\u2003Messages")),r.a.createElement(c.b,{to:"/user/profile/"+localStorage.getItem("username")},r.a.createElement("li",null,r.a.createElement("i",{class:"material-icons"},"account_circle"),"\u2003Profile")),r.a.createElement("button",{onClick:s},"Tweet")),r.a.createElement(O,Object.assign({},e,{setFormData:h,formData:E,handleCloseCreatePostOrComment:function(){h({}),o(!1)},setGif:p,ShowCreatePostOrComment:l,gif:d})))},C=a(69),I=a.n(C),k=a(124),B=a(68);var x=function(e){var t=function(e,t){e.preventDefault(),e.target.style.color="#063c5e"===e.target.style.color?"gray":"#063c5e";var a=new Headers;a.append("Authorization","Bearer "+localStorage.getItem("token")),a.append("content-type","application/json"),fetch("/users/posts/"+t,{method:"post",body:JSON.stringify({post_id:e.target.id}),headers:a}).then((function(e){return e.json()})).then((function(e){"success"===e.saved&&console.log("done")}))};return r.a.createElement("div",{id:"home-posts"},"home"===e.type?window.matchMedia("(max-width: 480px)").matches?r.a.createElement("div",{id:"home-profile-div"},r.a.createElement("img",{src:localStorage.getItem("imageUri"),alt:"profile pic",onClick:function(){return e.history.push("/user/profile/"+localStorage.getItem("username"))}}),r.a.createElement("p",null,r.a.createElement("strong",null," Home"))):r.a.createElement("h2",null,"Home"):"",r.a.createElement("div",{id:"home"===e.type?"home-div-posts":""},void 0!==e.posts&&e.posts.length>0?e.posts.map((function(a){return r.a.createElement("div",{key:a._id,className:"user_posts"},r.a.createElement("img",{src:"user"===e.type?localStorage.getItem("imageUri"):"home"===e.type?a.user_imageUri:a.userId.imageUri,alt:"pic",id:"user-post-img"}),r.a.createElement("div",{id:"post_detail"},r.a.createElement("p",{id:"post-user-detail"},r.a.createElement("strong",null,"user"===e.type?localStorage.getItem("f_name")+" "+localStorage.getItem("l_name"):"home"===e.type?a.name:a.userId.f_name+" "+a.userId.l_name),"\u2002",r.a.createElement("span",null,"user"===e.type?"@"+e.id:"home"===e.type?a.username:a.userId.username," \xb7 ",new Date(a.date).toLocaleDateString("en-us",{day:"numeric",month:"short"}))),r.a.createElement("div",{onClick:"comment"!==e.type?function(){return e.history.push("/user/post/"+a._id)}:""},a.postText,r.a.createElement("br",null),a.postImg&&r.a.createElement("img",{src:a.postImg,alt:"",id:"post-detail-img"}),a.postGif&&r.a.createElement("div",{id:"post-detail-gif-div"},r.a.createElement("img",{src:a.postGif,alt:""}))),r.a.createElement("div",{id:"like-share"},r.a.createElement("span",{onClick:function(e){return t(e,"like")}},r.a.createElement("i",{className:"material-icons",id:a._id,style:{color:-1===a.likes.indexOf(localStorage.getItem("id"))?"gray":"#063c5e"}},"thumb_up")," ","\u2002",a.likes.length),"comment"!==e.type?r.a.createElement("span",{onClick:function(e){return t(e,"share")}},r.a.createElement("i",{className:"material-icons",id:a._id,style:{color:-1===a.shares.indexOf(localStorage.getItem("id"))?"gray":"#063c5e"}}," ","share")," ","\u2002",a.shares.length):"",r.a.createElement("span",null,r.a.createElement("i",{className:"material-icons",onClick:e.handleShowCreateComment,id:a._id}," ","message")," ","\u2002","comment"!==e.type?a.comments.length:a.sub_comments.length))))})):"home"===e.type?r.a.createElement("h2",null,"No Posts to show... ",r.a.createElement("br",null),"Please follow some peoples..."):"",r.a.createElement(O,Object.assign({},e,{setFormData:e.setFormData,formData:e.formData,handleCloseCreatePostOrComment:e.handleCloseCreatePostOrComment,setGif:e.setGif,ShowCreatePostOrComment:e.ShowCreatePostOrComment,gif:e.gif,type:"commentOnComment",postId:e.postId}))))};var _=function(e){var t=Object(f.g)().id,a=Object(f.f)(),l=Object(n.useState)(""),o=Object(i.a)(l,2),c=o[0],s=o[1],d=Object(n.useState)({}),p=Object(i.a)(d,2),g=p[0],E=p[1];Object(n.useEffect)((function(){_()}),[t]);var h=Object(n.useState)(!1),b=Object(i.a)(h,2),y=b[0],v=b[1],w=Object(n.useState)(null),j=Object(i.a)(w,2),O=j[0],S=j[1],C=Object(n.useState)({}),I=Object(i.a)(C,2),k=I[0],B=I[1],_=function(){var e=new Headers;e.append("Authorization","Bearer "+localStorage.getItem("token")),fetch("/users/profile/"+t+"/posts",{method:"get",headers:e}).then((function(e){return e.json()})).then(function(){var e=Object(u.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("success"!==t.saved){e.next=3;break}return e.next=3,E(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return r.a.createElement(x,Object.assign({},e,{type:"user",history:a,posts:g.posts,setPosts:E,setFormData:B,formData:k,handleCloseCreatePostOrComment:function(){B({}),v(!1)},setGif:S,ShowCreatePostOrComment:y,gif:O,postId:c,handleShowCreateComment:function(e){s(e.target.id),v(!0)},id:t}))};var D=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),l=a[0],o=a[1],c=function(){return o(!1)},s=Object(n.useState)(!1),g=Object(i.a)(s,2),E=g[0],O=g[1],S=function(){return O(!1)},C=function(){return O(!0)},x=Object(n.useState)(!1),D=Object(i.a)(x,2),H=D[0],F=D[1],L=function(){return F(!1)},N=function(){return F(!0)},P=Object(n.useState)({}),T=Object(i.a)(P,2),G=T[0],U=T[1],A=Object(n.useState)({f_name:"",l_name:"",bio:"",location:"",username:""}),M=Object(i.a)(A,2),z=M[0],q=M[1],J=Object(f.g)().id;Object(n.useEffect)((function(){W()}),[J]);var W=function(){var e=new Headers;e.append("Authorization","Bearer "+localStorage.getItem("token")),e.append("content-type","application/json"),fetch("/users/profile/",{method:"POST",body:JSON.stringify({username:"@"+J}),headers:e}).then((function(e){return e.json()})).then(function(){var e=Object(u.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(t.details);case 2:localStorage.setItem("f_name",t.details.f_name),localStorage.setItem("l_name",t.details.l_name),localStorage.setItem("imageUri",t.details.imageUri),null!==document.querySelector(".follow-button")&&(document.querySelector(".follow-button").innerHTML=-1===t.details.followers.indexOf(t.id)?"Follow":"Unfollow");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},Y=Object(f.f)(),R=function(e){var t=document.getElementById("edit-alert");if(t.style.display="block",e.error&&(t.innerHTML+=e.error.msg),e.errors){var a=1;e.errors.map((function(e){t.innerHTML+="<p>"+a+". "+e.msg+"<br/></p>",a++}))}setTimeout((function(){t.style.display="none"}),1e4)},K=function(e,t){e.preventDefault(),document.getElementById("upload-"+t+"-button").disabled=!0,document.getElementById(t+"-upload-spinner").style.display="inline-block";var a=e.target[0].files[0],n=new FormData;n.append("image",a);var r=new Headers;r.append("Authorization","Bearer "+localStorage.getItem("token")),fetch("/users/profile/upload/"+t,{method:"post",body:n,headers:r}).then((function(e){return e.json()})).then((function(e){"success"===e.saved&&("profile"===t?S():L(),W())}))},Z=function(e,t){document.getElementById(t+"-pic-upload").className="custom-file-input "+("image/png"===e.target.files[0].type||"image/jpeg"===e.target.files[0].type?"is-valid":"is-invalid"),document.getElementById(t+"-pic-upload-label").innerHTML=e.target.files[0].name,document.getElementById("upload-"+t+"-button").disabled="is-valid"!==document.getElementById(t+"-pic-upload").className.split(" ")[1]};return r.a.createElement("div",null,r.a.createElement("div",{id:"profile-head"},r.a.createElement("strong",null,G.f_name+" "+G.l_name),r.a.createElement("br",null),G.posts&&G.posts.length," Tweets"),r.a.createElement("div",{id:"body"},""===G.coverImageUri?r.a.createElement("div",{id:"cover-image",onClick:localStorage.getItem("username")===J?N:""}):r.a.createElement("img",{id:"cover-image",src:G.coverImageUri,alt:"cover",onClick:localStorage.getItem("username")===J?N:""}),""===G.imageUri?r.a.createElement("img",{src:I.a,alt:"no profile",id:"profile-pic",onClick:localStorage.getItem("username")===J?C:""}):r.a.createElement("img",{src:G.imageUri,alt:"profile",id:"profile-pic",onClick:localStorage.getItem("username")===J?C:""}),r.a.createElement("div",{id:"profile-div"},r.a.createElement("div",{style:{justifySelf:"right",padding:"0",alignItems:"center"}},localStorage.getItem("username")===J?r.a.createElement("button",{id:"button",className:"edit-button",onClick:function(){return o(!0)}},"Edit Profile"):r.a.createElement("button",{id:"button",className:"follow-button",onClick:function(e){e.preventDefault();var t=new Headers;t.append("Authorization","Bearer "+localStorage.getItem("token")),fetch("/users/profile/"+J+"/follow",{method:"get",headers:t}).then((function(e){return e.json()})).then((function(e){"success"===e.saved&&W()}))}},"Follow")),r.a.createElement("div",null,"\xa0",r.a.createElement("strong",null,G.f_name+" "+G.l_name),r.a.createElement("br",null),"\xa0",r.a.createElement("span",null,G.username)),r.a.createElement("div",null,G.bio),r.a.createElement("div",null,r.a.createElement("span",null,r.a.createElement("i",{class:"material-icons"},"location_on"),G.location+" ","\xa0",r.a.createElement("i",{class:"material-icons"}," date_range")," "," Joined "+new Date(G.join_date).toLocaleDateString("en-US",{month:"long",year:"numeric"}))),r.a.createElement("div",null,"\xa0",r.a.createElement("strong",null,(void 0===G.following?0:G.following.length)+" ")," ",r.a.createElement("span",null,"Following"),"\u2003",r.a.createElement("strong",null," "+(void 0===G.followers?0:G.followers.length)+" "),r.a.createElement("span",null,"Followers")),r.a.createElement("div",{style:{justifySelf:"center",padding:"0"}},r.a.createElement("strong",null,"Tweets")," ")),r.a.createElement("div",null,r.a.createElement(_,null)),r.a.createElement(h.a,Object.assign({show:l,onHide:c},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0,backdrop:"static",keyboard:!1}),r.a.createElement(h.a.Header,{closeButton:""!==G.username},r.a.createElement(h.a.Title,null,"Edit Profile")),r.a.createElement(h.a.Body,null,r.a.createElement(b.a,{variant:"danger",style:{display:"none"},id:"edit-alert"}),r.a.createElement(y.a,{onChange:function(e){var t=e.target.name,a=e.target.value;q(Object(p.a)({},z,Object(d.a)({},t,a)))},onSubmit:function(e){e.preventDefault();var t=Object(p.a)({},z),a=new Headers;a.append("Authorization","Bearer "+localStorage.getItem("token")),a.append("content-type","application/json"),fetch("/users/update",{method:"Post",body:JSON.stringify(t),headers:a}).then((function(e){return e.json()})).then((function(e){if("success"===e.saved){var t=document.getElementById("edit-alert");t.className="fade alert alert-success show",t.style.display="block",t.innerHTML="Your details had been saved...",J=z.username,localStorage.setItem("username",z.username),setTimeout((function(){c()}),2e3),Y.push("/user/profile/"+J)}else R(e)}))}},r.a.createElement(k.a,null,r.a.createElement(B.a,null,r.a.createElement(y.a.Group,{controlId:"formBasicFirstName"},r.a.createElement(y.a.Label,null,"First Name"),r.a.createElement(y.a.Control,{type:"text",placeholder:"Enter First Name",name:"f_name",required:!0}))),r.a.createElement(B.a,null,r.a.createElement(y.a.Group,{controlId:"formBasicLastName"},r.a.createElement(y.a.Label,null,"Last Name"),r.a.createElement(y.a.Control,{type:"text",placeholder:"Enter Last Name",name:"l_name",required:!0})))),r.a.createElement(y.a.Group,{controlId:"formBasicUsername"},r.a.createElement(y.a.Label,null,"Username"),r.a.createElement(y.a.Control,{type:"text",placeholder:"Enter Username",name:"username",required:!0})),r.a.createElement(y.a.Group,{controlId:"formBasicBio"},r.a.createElement(y.a.Label,null,"Bio"),r.a.createElement(y.a.Control,{type:"bio",placeholder:"Add Your Bio",name:"bio",required:!0})),r.a.createElement(y.a.Group,{controlId:"formBasicLocation"},r.a.createElement(y.a.Label,null,"Location"),r.a.createElement(y.a.Control,{type:"text",placeholder:"Add Your location",name:"location",required:!0})),r.a.createElement(w.a,{variant:"primary",type:"submit",id:"login-button"},"Save")))),r.a.createElement(h.a,Object.assign({show:E,onHide:S},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0,backdrop:"static"}),r.a.createElement(h.a.Header,{closeButton:!0},r.a.createElement(h.a.Title,null,"Update Profile Pic")),r.a.createElement(h.a.Body,null,r.a.createElement(y.a,{onSubmit:function(e){return K(e,"profile")}},r.a.createElement(v.a,null,r.a.createElement(y.a.File,{id:"profile-pic-upload",custom:!0},r.a.createElement(y.a.File.Input,{onChange:function(e){return Z(e,"profile")}}),r.a.createElement(y.a.File.Label,{"data-browse":"Browse",id:"profile-pic-upload-label"},"Choose Your Pic"),r.a.createElement(y.a.Control.Feedback,{type:"invalid"},"wrong file format (only .jpg and .png allowed)"))),r.a.createElement(w.a,{variant:"primary",type:"submit",id:"upload-profile-button",disabled:!0},"Upload"),"\u2003",r.a.createElement(j.a,{animation:"border",variant:"primary",size:"sm",id:"profile-upload-spinner",style:{display:"none"}})))),r.a.createElement(h.a,Object.assign({show:H,onHide:L},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0,backdrop:"static"}),r.a.createElement(h.a.Header,{closeButton:!0},r.a.createElement(h.a.Title,null,"Update Profile Cover")),r.a.createElement(h.a.Body,null,r.a.createElement(y.a,{onSubmit:function(e){return K(e,"profile-cover")}},r.a.createElement(v.a,null,r.a.createElement(y.a.File,{id:"profile-cover-pic-upload",custom:!0},r.a.createElement(y.a.File.Input,{onChange:function(e){return Z(e,"profile-cover")}}),r.a.createElement(y.a.File.Label,{"data-browse":"Browse",id:"profile-cover-pic-upload-label"},"Choose Your Pic"),r.a.createElement(y.a.Control.Feedback,{type:"invalid"},"wrong file format (only .jpg and .png allowed)"))),r.a.createElement(w.a,{variant:"primary",type:"submit",id:"upload-profile-cover-button",disabled:!0},"Upload"),"\u2003",r.a.createElement(j.a,{animation:"border",variant:"primary",size:"sm",id:"profile-cover-upload-spinner",style:{display:"none"}}))))))},H=a(24),F=a.n(H);var L=function(e){var t=Object(n.useContext)(q),a=new g.GiphyFetch("tivenjqL1A6W3LpKpPZ4StawMGFAcjdD"),l=Object(n.useState)({}),o=Object(i.a)(l,2),c=o[0],s=o[1],d=Object(n.useState)(!1),p=Object(i.a)(d,2),f=p[0],y=p[1],v=function(){return y(!1)};Object(n.useEffect)((function(){if(Object.keys(t.state).length>0){var e=setInterval((function(){return w()}),2e3);return function(){return clearInterval(e)}}}),[t.state]);var w=function(){var e=new Headers;e.append("Authorization","Bearer "+localStorage.getItem("token")),e.append("content-type","application/json"),fetch("/users/messages",{method:"post",body:JSON.stringify({friend_id:t.state.id}),headers:e}).then((function(e){return e.json()})).then((function(e){"success"===e.saved?(e.length=e.msgs.chat.length,s(e)):s({saved:"unsuccessful"})}))},j=function(e,a){var n=new FormData;n.append(e,a),n.append("friendId",t.state.id),"success"===c.saved?n.append("msgBoxId",c.msgs._id):n.append("msgBoxId","");var r=new Headers;r.append("Authorization","Bearer "+localStorage.getItem("token")),fetch("/users/sendMsg",{method:"post",body:n,headers:r}).then((function(e){return e.json()})).then((function(t){"success"===t.saved&&("gif"===e&&v(),"text"===e&&(document.getElementById("text").value=""),w())}))},O=function(){var e=Object(u.a)(m.a.mark((function e(t,n){var r,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,a.gif(t.id);case 3:r=e.sent,l=r.data,j("gif",l.images.preview_webp.url);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement("div",{id:"message-left"},0===Object.keys(t.state).length?r.a.createElement("div",{id:"msg-not-selected"},r.a.createElement("h2",null,"You don't have a message selected"),r.a.createElement("span",null,"Select one of your friend to message")):r.a.createElement("div",{id:"msg-box"},r.a.createElement("div",{id:"msg-box-profile"},r.a.createElement("img",{src:t.state.imageUri,alt:t.state.name+" pic"}),r.a.createElement("div",null,r.a.createElement("strong",null,t.state.name),r.a.createElement("br",null),r.a.createElement("span",null,t.state.username))),r.a.createElement(b.a,{variant:"danger",style:{display:"none"},id:"wrong-image-alert"}),r.a.createElement("div",{id:"msg-box-msgs"},void 0!==c.msgs&&c.msgs.chat.map((function(e){var t="",a=document.getElementById("msg-box-msgs");return a.scrollTop=a.scrollHeight,t=e.senderId===localStorage.getItem("id")?"right":"left",e.text?r.a.createElement("div",{key:e._id,class:t},r.a.createElement("li",null,e.text,"\u2002",r.a.createElement("span",null,F()(e.sent_time).format("HH:mm A")))):e.image?r.a.createElement("div",{key:e._id,class:t},r.a.createElement("img",{src:e.image,alt:""}),r.a.createElement("br",null),r.a.createElement("span",null,F()(e.sent_time).format("HH:mm A"))):r.a.createElement("div",{key:e._id,class:t},r.a.createElement("img",{src:e.gif,alt:""}),r.a.createElement("br",null),r.a.createElement("span",null,F()(e.sent_time).format("HH:mm A")))}))),r.a.createElement("div",{id:"msg-box-bottom-div"},r.a.createElement("i",{className:"material-icons",onClick:function(){return document.getElementById("send-image").click()}},"image"),r.a.createElement("i",{className:"material-icons",onClick:function(){return y(!0)}},"gif"),r.a.createElement("input",{type:"text",placeholder:"Type your msg here... press enter to send",id:"text",onKeyDown:function(e){13===e.keyCode&&j("text",document.getElementById("text").value)}}))),r.a.createElement("input",{type:"file",name:"image",id:"send-image",onChange:function(e){var t=e.target.files[0],a=document.getElementById("wrong-image-alert");"image/jpeg"!==t.type&&"image/png"!==t.type?(a.style.display="block",a.innerHTML="Only .jpeg or .png files allowed...",setInterval((function(){return a.style.display="none"}),2e3),e.target.value=""):j("image",t)},style:{display:"none"}}),r.a.createElement(h.a,Object.assign({show:f,onHide:v},e,{size:"md",centered:!0}),r.a.createElement(h.a.Header,{closeButton:!0},r.a.createElement(h.a.Title,null,"Select Gif")),r.a.createElement(h.a.Body,null,r.a.createElement("div",{id:"gif-modal"},r.a.createElement(E.Grid,{fetchGifs:function(e){return a.emoji({offset:e,limit:10})},width:window.matchMedia("(max-width: 480px)").matches?250:450,columns:window.matchMedia("(max-width: 480px)").matches?2:3,hideAttribution:!0,onGifClick:O})))))};var N=function(e){var t=Object(f.f)(),a=Object(n.useState)([]),l=Object(i.a)(a,2),o=l[0],c=l[1];Object(n.useEffect)((function(){return B()}),[]);var s=Object(n.useState)(""),d=Object(i.a)(s,2),p=d[0],g=d[1],E=Object(n.useState)(!1),h=Object(i.a)(E,2),b=h[0],y=h[1],v=Object(n.useState)(null),w=Object(i.a)(v,2),j=w[0],O=w[1],S=Object(n.useState)({}),C=Object(i.a)(S,2),I=C[0],k=C[1],B=function(){var e=new Headers;e.append("Authorization","Bearer "+localStorage.getItem("token")),fetch("/users/homePosts",{method:"get",headers:e}).then((function(e){return e.json()})).then(function(){var e=Object(u.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"success"===t.saved&&(t.details.sort((function(e,t){return new Date(t.sent_time).getSeconds-new Date(e.sent_time).getSeconds})),c(t.details));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return r.a.createElement(x,Object.assign({},e,{type:"home",history:t,posts:o,setPosts:c,setFormData:k,formData:I,handleCloseCreatePostOrComment:function(){k({}),y(!1)},setGif:O,ShowCreatePostOrComment:b,gif:j,postId:p,handleShowCreateComment:function(e){g(e.target.id),y(!0)}}))},P=a(125),T=a(67);var G=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],l=t[1];Object(n.useEffect)((function(){c()}),[]);var o=Object(n.useContext)(q),c=function(){var e=new Headers;e.append("Authorization","Bearer "+localStorage.getItem("token")),fetch("/users/friend-list",{method:"get",headers:e}).then((function(e){return e.json()})).then((function(e){"success"===e.saved&&l(e.data)}))};return r.a.createElement("div",{id:"messages-right"},r.a.createElement("p",null,r.a.createElement("strong",null,"Messages")," "),r.a.createElement("div",{id:"msg-people-search"},r.a.createElement(P.a,{className:"mb-3"},r.a.createElement(P.a.Prepend,null,r.a.createElement(P.a.Text,null,r.a.createElement("i",{className:"material-icons"},"\ue8b6"))),r.a.createElement(T.a,{placeholder:"Search your Friends"}))),a.map((function(e){return r.a.createElement("div",{key:e.id,id:"msg-profile-pic",onClick:function(){return o.dispatch({type:"change",payload:e})}},r.a.createElement("img",{src:e.imageUri,alt:e.name+" pic"}),r.a.createElement("div",null,e.name,r.a.createElement("br",null),e.username))})))};var U=function(e){var t=Object(f.g)().id,a=Object(n.useState)(""),l=Object(i.a)(a,2),o=(l[0],l[1]),c=Object(n.useState)({}),s=Object(i.a)(c,2),m=s[0],u=s[1];Object(n.useEffect)((function(){return J()}),[]);var d=Object(n.useState)(!1),p=Object(i.a)(d,2),g=p[0],E=p[1],h=Object(n.useState)(null),b=Object(i.a)(h,2),y=b[0],v=b[1],w=Object(n.useState)({}),j=Object(i.a)(w,2),S=j[0],C=j[1],I=Object(n.useState)(null),k=Object(i.a)(I,2),B=k[0],_=k[1],D=Object(n.useState)({}),H=Object(i.a)(D,2),L=H[0],N=H[1],P=Object(n.useState)(""),T=Object(i.a)(P,2),G=T[0],U=T[1],A=Object(n.useState)(!1),M=Object(i.a)(A,2),z=M[0],q=M[1],J=function(){var e=new Headers;e.append("Authorization","Bearer "+localStorage.getItem("token")),fetch("/users/post/"+t,{method:"get",headers:e}).then((function(e){return e.json()})).then((function(e){console.log(e),"success"===e.saved&&(u(e.details),console.log(e.details))}))},W=function(e,a){e.preventDefault();var n=e.target,r=new Headers;r.append("Authorization","Bearer "+localStorage.getItem("token")),r.append("content-type","application/json"),fetch("/users/posts/"+a,{method:"post",body:JSON.stringify({post_id:t}),headers:r}).then((function(e){return e.json()})).then((function(e){"success"===e.saved&&(console.log("done"),n.style.color="blue"===n.style.color?"gray":"blue")}))};return Object.keys(m).length>0&&r.a.createElement("div",null,r.a.createElement("div",{id:"single-post-head"},r.a.createElement("h3",null,r.a.createElement("strong",null,"Post"))),r.a.createElement("div",{id:"single-post-profile"},r.a.createElement("img",{src:m.imageUri,alt:m.name+" profile pic"}),r.a.createElement("div",null,r.a.createElement("strong",null,m.name),r.a.createElement("br",null),r.a.createElement("span",null,m.username))),r.a.createElement("div",null,r.a.createElement("div",{id:"single-post-detail"},m.postText),r.a.createElement("div",{id:"single-post-date"},r.a.createElement("span",null,F()(m.date).format("HH:mm A")+" \xb7 "+F()(m.date).format("ll"))),r.a.createElement("div",{id:"single-post-likeshare"},r.a.createElement("strong",null,m.likes.length),r.a.createElement("span",null," Likes")," \u2003",r.a.createElement("strong",null,m.shares.length),r.a.createElement("span",null," Shares")),r.a.createElement("div",{id:"likesharecomment"},r.a.createElement("span",{onClick:function(e){return W(e,"like")},style:{color:-1===m.likes.indexOf(localStorage.getItem("id"))?"gray":"blue"}},r.a.createElement("i",{className:"material-icons"},"thumb_up"),"\u2002 Like"),r.a.createElement("span",{onClick:function(e){return W(e,"share")},style:{color:-1===m.shares.indexOf(localStorage.getItem("id"))?"gray":"blue"}},r.a.createElement("i",{className:"material-icons"}," share"),"\u2002 Share"),r.a.createElement("span",null,r.a.createElement("i",{className:"material-icons",onClick:function(e){o(e.target.id),E(!0)}}," ","message"),"\u2002 Comment"))),r.a.createElement(x,Object.assign({},e,{type:"comment",posts:m.comments,setFormData:N,formData:L,handleCloseCreatePostOrComment:function(){N({}),q(!1)},setGif:_,ShowCreatePostOrComment:z,gif:B,postId:G,handleShowCreateComment:function(e){U(e.target.id),q(!0)}})),r.a.createElement(O,Object.assign({},e,{setFormData:C,formData:S,handleCloseCreatePostOrComment:function(){C({}),E(!1)},setGif:v,ShowCreatePostOrComment:g,gif:y,type:"comment",postId:t})))};var A=function(){var e=Object(n.useContext)(q);return r.a.createElement("div",{class:"main-left"},r.a.createElement(f.c,null,r.a.createElement(f.a,{path:"/user/",exact:!0,component:N}),r.a.createElement(f.a,{path:"/user/profile/:id",component:D}),r.a.createElement(f.a,{path:"/user/messages",component:window.matchMedia("(max-width: 480px)").matches?Object.keys(e.state).length>0?L:G:L}),r.a.createElement(f.a,{path:"/user/post/:id",component:U})))};var M=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],l=t[1];return r.a.createElement("div",{className:"profile-side-bar"},r.a.createElement("form",{onChange:function(e){document.getElementById("search-people-results").style.display="block";var t=e.target.value,a=new Headers;a.append("Authorization","Bearer "+localStorage.getItem("token")),a.append("content-type","application/json"),""!==t?fetch("/users/search",{method:"post",body:JSON.stringify({value:t}),headers:a}).then((function(e){return e.json()})).then(function(){var e=Object(u.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):document.getElementById("search-people-results").style.display="none"}},r.a.createElement(P.a,{className:"mb-3"},r.a.createElement(P.a.Prepend,null,r.a.createElement(P.a.Text,null,r.a.createElement("i",{className:"material-icons"},"\ue8b6"))),r.a.createElement(T.a,{placeholder:"Search your Friends",name:"search"})),r.a.createElement("ul",{id:"search-people-results"},a.map((function(e){return r.a.createElement(c.b,{to:"/user/profile/"+e.username.split("@")[1]},r.a.createElement("li",null,r.a.createElement("img",{src:e.imageUri,alt:"profile"}),r.a.createElement("div",null,e.f_name+" "+e.l_name," ",r.a.createElement("br",null),e.username)))})))))};var z=function(){return r.a.createElement("div",{className:"main-right"},r.a.createElement(f.c,null,r.a.createElement(f.a,{path:"/user/profile/:id",component:M}),r.a.createElement(f.a,{path:"/user/messages",component:G})))},q=r.a.createContext();var J=function(){var e=Object(n.useReducer)((function(e,t){switch(t.type){case"change":return t.payload;default:return e}}),{}),t=Object(i.a)(e,2),a=t[0],l=t[1];return r.a.createElement("div",{id:"main"},r.a.createElement(q.Provider,{value:{state:a,dispatch:l}},r.a.createElement(A,null),r.a.createElement(z,null)))};var W=function(){return r.a.createElement("div",{id:"user"},r.a.createElement(J,null),r.a.createElement(S,null))};var Y=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),l=a[0],o=a[1],c=function(){o(!0),D()},s=Object(n.useState)(!1),m=Object(i.a)(s,2),u=m[0],g=m[1],E=function(){return g(!1)},v=Object(n.useState)({email:"",password:"",method:"native"}),j=Object(i.a)(v,2),O=j[0],S=j[1],C=Object(n.useState)({f_name:"",l_name:"",email:"",password:"",method:"native",imageUri:""}),I=Object(i.a)(C,2),x=I[0],_=I[1],D=function(){var e=document.createElement("script");e.async=!0,e.defer=!0,e.crossorigin="anonymous",e.src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v6.0&appId=593870491214414&autoLogAppEvents=1",document.head.appendChild(e),F()},H=Object(n.useRef)(),F=function(){var e=document.createElement("script");e.src="https://apis.google.com/js/platform.js?onload=googleSDKLoaded",e.async=!0,e.defer=!0,document.head.appendChild(e),window.googleSDKLoaded=function(){window.gapi.load("auth2",(function(){window.auth2=window.gapi.auth2.init({client_id:"696463816448-rsbv7ci8el2kmd18q582li2832bbuvpl.apps.googleusercontent.com",cookiepolicy:"single_host_origin",scope:"profile email"}),function(){var e=H.current.attributes[0].value;window.auth2.attachClickHandler(H.current,{},(function(t){var a=t.getBasicProfile();"register"===e?(_({f_name:a.getGivenName(),l_name:a.getFamilyName(),email:a.getEmail(),imageUri:a.getImageUrl(),method:"google"}),document.getElementById("register-button").click()):(S({email:a.getEmail(),method:"google",password:"no"}),document.getElementById("login-button").click())}),(function(e){alert(JSON.stringify(e,void 0,2))}))}()}))}},L=function(e,t){var a=document.getElementById(t);if(a.style.display="block",e.error&&(a.innerHTML+=e.error.msg),e.errors){var n=1;e.errors.map((function(e){a.innerHTML+="<p>"+n+". "+e.msg+"<br/></p>",n++}))}setTimeout((function(){a.style.display="none"}),1e4)},N=Object(f.f)(),P=function(e,t){e.preventDefault(),window.FB.login((function(e){"connected"===e.status&&window.FB.api("/me?fields=email"+("register"===t?",first_name,last_name,picture":""),(function(e){"login"===t?(S({email:e.email,method:"facebook",password:"no"}),document.getElementById("login-button").click()):(console.log(e),_({f_name:e.first_name,l_name:e.last_name,email:e.email,imageUri:e.picture.data.url,method:"facebook"}),document.getElementById("register-button").click())}))}),{scope:"public_profile,email"})};return r.a.createElement("div",{id:"home"},r.a.createElement("div",null,"Welcome To InstaChat"),r.a.createElement("div",null,r.a.createElement("button",{onClick:c},"Login"),r.a.createElement("button",{onClick:function(){g(!0),D()}},"Sign Up")),r.a.createElement(h.a,Object.assign({show:l,onHide:function(){return o(!1)}},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),r.a.createElement(h.a.Header,{closeButton:!0},r.a.createElement(h.a.Title,null,"Login")),r.a.createElement(h.a.Body,null,r.a.createElement(b.a,{variant:"danger",style:{display:"none"},id:"login-alert"}),r.a.createElement(y.a,{onSubmit:function(e){e.preventDefault();var t=Object(p.a)({},O);fetch("/users/login/",{method:"POST",body:JSON.stringify(t),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){return e.json()})).then((function(e){"success"===e.saved?(console.log(e),localStorage.setItem("token",e.token),localStorage.setItem("id",e._id),localStorage.setItem("username",e.username),localStorage.setItem("f_name",e.f_name),localStorage.setItem("l_name",e.l_name),localStorage.setItem("imageUri",e.imageUri),N.push("/user/profile/"+e.username)):L(e,"login-alert")}))},onChange:function(e){var t=e.target.name,a=e.target.value;S(Object(p.a)({},O,Object(d.a)({},t,a)))}},r.a.createElement(y.a.Group,{controlId:"formBasicEmail"},r.a.createElement(y.a.Label,null,"Email address"),r.a.createElement(y.a.Control,{type:"email",placeholder:"Enter email",name:"email"})),r.a.createElement(y.a.Group,{controlId:"formBasicPassword"},r.a.createElement(y.a.Label,null,"Password"),r.a.createElement(y.a.Control,{type:"password",placeholder:"Password",name:"password"})),r.a.createElement(w.a,{variant:"primary",type:"submit",id:"login-button"},"Login"))),r.a.createElement(h.a.Footer,null,r.a.createElement(w.a,{ref:H,button_type:"login"},"Login with Google"),r.a.createElement(w.a,{onClick:function(e){return P(e,"login")}},"Login with FaceBook"))),r.a.createElement(h.a,Object.assign({show:u,onHide:E},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),r.a.createElement(h.a.Header,{closeButton:!0},r.a.createElement(h.a.Title,null,"Register")),r.a.createElement(h.a.Body,null,r.a.createElement(b.a,{id:"register-alert",variant:"danger",style:{display:"none"}}),r.a.createElement(y.a,{onSubmit:function(e){e.preventDefault();var t=Object(p.a)({},x);fetch("/users/register/",{method:"POST",body:JSON.stringify(t),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){return e.json()})).then((function(e){if("success"===e.saved){var t=document.getElementById("register-alert");t.className="fade alert alert-success show",t.style.display="block",t.innerHTML="Registration Successful...\nProceed to Login.",setTimeout((function(){E(),c()}),2e3)}else L(e,"register-alert")}))},onChange:function(e){var t=e.target.name,a=e.target.value;_(Object(p.a)({},x,Object(d.a)({},t,a)))}},r.a.createElement(k.a,null,r.a.createElement(B.a,null,r.a.createElement(y.a.Group,{controlId:"formBasicEmail"},r.a.createElement(y.a.Label,null,"First Name"),r.a.createElement(y.a.Control,{type:"text",placeholder:"First Name",name:"f_name",value:x.f_name,required:!0}))),r.a.createElement(B.a,null,r.a.createElement(y.a.Group,{controlId:"formBasicEmail"},r.a.createElement(y.a.Label,null,"Last Name"),r.a.createElement(y.a.Control,{type:"text",placeholder:"Last Name",name:"l_name",value:x.l_name,required:!0})))),r.a.createElement(y.a.Group,{controlId:"formBasicEmail"},r.a.createElement(y.a.Label,null,"Email address"),r.a.createElement(y.a.Control,{type:"email",placeholder:"Enter email",name:"email",value:x.email,required:!0})),r.a.createElement(y.a.Group,{controlId:"formBasicPassword"},r.a.createElement(y.a.Label,null,"Password"),r.a.createElement(y.a.Control,{type:"password",placeholder:"Password",name:"password",value:x.password})),r.a.createElement(w.a,{variant:"primary",type:"submit",id:"register-button"},"Sign Up"))),r.a.createElement(h.a.Footer,null,r.a.createElement(w.a,{ref:H,button_type:"register"},"SignUp with Google"),r.a.createElement(w.a,{onClick:function(e){return P(e,"register")}},"SignUp with FaceBook"))))};var R=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(c.a,null,r.a.createElement(f.c,null,r.a.createElement(f.a,{path:"/login",exact:!0,component:Y}),r.a.createElement(f.a,{path:"/user/",component:W}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(R,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},69:function(e,t,a){e.exports=a.p+"static/media/avtar.1e976c46.png"},71:function(e,t,a){e.exports=a(118)},76:function(e,t,a){},97:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=97}},[[71,1,2]]]);
//# sourceMappingURL=main.4f404538.chunk.js.map