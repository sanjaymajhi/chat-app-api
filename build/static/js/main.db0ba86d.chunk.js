(this["webpackJsonpchat-app-client"]=this["webpackJsonpchat-app-client"]||[]).push([[0],{118:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(19),o=a.n(r),i=(a(76),a(77),a(5)),c=a(7),s=a(10),m=a.n(s),u=a(13),d=a(18),p=a(16),f=a(22),g=a(26),E=a(28),h=a(126),b=a(121),y=a(127),v=a(66),j=a(122),O=a(123);var w=function(e){var t=new g.GiphyFetch("tivenjqL1A6W3LpKpPZ4StawMGFAcjdD"),a=(Object(f.f)(),function(e){var t=document.getElementById("post-"+e+"-select");"emoji"===e?document.getElementById("post-gif-select").style.display="none":document.getElementById("post-emoji-select").style.display="none","block"===t.style.display?t.style.display="none":t.style.display="block"}),n=function(){var a=Object(u.a)(m.a.mark((function a(n,l){var r,o;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return l.preventDefault(),document.getElementById("post-img-div").style.display="none",document.getElementById("post-gif-div").style.display="block",a.next=5,t.gif(n.id);case 5:return r=a.sent,o=r.data,a.next=9,e.setFormData({"post-text":e.formData["post-text"],"gif-id":o.images.preview_webp.url});case 9:e.setGif(o);case 10:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}();return l.a.createElement("div",null,l.a.createElement(h.a,Object.assign({show:e.ShowCreatePostOrComment,onHide:e.handleCloseCreatePostOrComment},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),l.a.createElement(h.a.Header,{closeButton:!0},l.a.createElement(h.a.Title,null,"comment"===e.type?"Write a Comment":"Create Post")),l.a.createElement(h.a.Body,null,l.a.createElement(b.a,{variant:"danger",style:{display:"none"},id:"post-alert"}),l.a.createElement("div",{id:"post-profile-div"},l.a.createElement("img",{src:localStorage.getItem("imageUri"),alt:"profile"}),"\u2003",l.a.createElement("span",null,l.a.createElement("strong",null,localStorage.getItem("f_name")+" "+localStorage.getItem("l_name")))),l.a.createElement(y.a,{onChange:function(t){var a=t.target.name,n=t.target.value;"post-img"===t.target.name?e.setFormData(Object(p.a)({},e.formData,Object(d.a)({},a,t.target.files[0]))):e.setFormData(Object(p.a)({},e.formData,Object(d.a)({},a,n)))},onSubmit:function(t){t.preventDefault(),document.getElementById("post-spinner").style.display="inline-block";var a=new FormData;console.log(e.postId),a.append("post-text",e.formData["post-text"]),a.append("post-gif",e.formData["gif-id"]),a.append("image",e.formData["post-img"]),"comment"===e.type&&a.append("postId",e.postId);var n="comment"===e.type?"/users/profile/post/comment":"commentOnComment"===e.type?"/users/profile/post/commentOnComment":"/users/profile/post/";fetch(n,{method:"Post",body:a,headers:{token:localStorage.getItem("token")}}).then((function(e){return e.json()})).then((function(t){if("success"===t.saved){var a=document.getElementById("post-alert");a.className="fade alert alert-success show",a.style.display="block",a.innerHTML="Your details had been saved...",setTimeout((function(){e.handleCloseCreatePostOrComment()}),2e3)}else document.getElementById("post-spinner").style.display="none",function(e){var t=document.getElementById("post-alert");if(t.style.display="block",e.error&&(t.innerHTML+=e.error.msg),e.errors){var a=1;e.errors.map((function(e){t.innerHTML+="<p>"+a+". "+e.msg+"<br/></p>",a++}))}setTimeout((function(){t.style.display="none"}),1e4)}(t)}))}},l.a.createElement(v.a,null,l.a.createElement(y.a.Control,{plaintext:!0,as:"textarea",rows:"3",placeholder:"comment"===e.type?"Type your comment here...":"What's on your mind "+localStorage.getItem("f_name"),name:"post-text",id:"post-text",required:!0})),l.a.createElement(v.a,null,l.a.createElement(y.a.File,{id:"post-pic-upload",custom:!0,style:{display:"none"}},l.a.createElement(y.a.File.Input,{name:"post-img",onChange:function(e){var t=e.target.files[0],a=document.getElementById("post-alert");if("image/jpeg"!==t.type&&"image/png"!==t.type)a.style.display="block",a.innerHTML="Only .jpeg or .png files allowed...",e.target.value="";else{var n=new FileReader;n.onload=function(e){document.getElementById("post-img-show").src=e.target.result},n.readAsDataURL(t),document.getElementById("post-gif-div").style.display="none",document.getElementById("post-img-div").style.display="block"}}}))),l.a.createElement("div",{id:"post-img-div"},l.a.createElement("div",null,l.a.createElement("i",{className:"material-icons",onClick:function(){document.getElementById("post-pic-upload").value="",document.getElementById("post-img-div").style.display="none",e.setFormData({"post-text":e.formData["post-text"]})}}," ","remove_circle"),l.a.createElement("img",{src:"#",alt:"",id:"post-img-show"}))),l.a.createElement("div",{id:"post-gif-div"},e.gif&&l.a.createElement(E.Gif,{gif:e.gif,width:window.matchMedia("(max-width: 480px)").matches?150:200,hideAttribution:!0}),l.a.createElement("i",{className:"material-icons",onClick:function(){e.setGif(null),e.setFormData({"post-text":e.formData["post-text"]}),document.getElementById("post-gif-div").style.display="none"}}," ","remove_circle")),l.a.createElement(j.a,{variant:"primary",type:"submit",id:"post-button",style:{width:"100%"}},l.a.createElement("strong",null,e.type||"Post"),"\u2003",l.a.createElement(O.a,{animation:"border",variant:"dark",size:"sm",id:"post-spinner",style:{display:"none"}})))),l.a.createElement(h.a.Footer,{id:"post-footer"},l.a.createElement("strong",{style:{justifySelf:"left"}},"Add to your ",e.type||"post"),l.a.createElement(j.a,{variant:"light"},l.a.createElement("i",{className:"material-icons",onClick:function(){return document.getElementById("post-pic-upload").click()}},"image")),l.a.createElement(j.a,{variant:"light"}," ",l.a.createElement("i",{className:"material-icons",onClick:function(){return a("gif")}},"gif")),l.a.createElement(j.a,{variant:"light",onClick:function(){return a("emoji")}},l.a.createElement("span",null,"\ud83d\ude04")," "),l.a.createElement("div",{id:"post-emoji-select"}," ",l.a.createElement(E.Grid,{width:window.matchMedia("(max-width: 480px)").matches?250:450,columns:window.matchMedia("(max-width: 480px)").matches?2:3,fetchGifs:function(e){return t.emoji({offset:e,limit:10})},hideAttribution:!0,onGifClick:function(e,t){return n(e,t)}})),l.a.createElement("div",{id:"post-gif-select"}," ",l.a.createElement(E.Grid,{width:window.matchMedia("(max-width: 480px)").matches?250:450,columns:window.matchMedia("(max-width: 480px)").matches?2:3,fetchGifs:function(e){return t.trending({offset:e,limit:10})},hideAttribution:!0,onGifClick:function(e,t){return n(e,t)}})))))};var S=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),r=a[0],o=a[1],s=function(){return o(!0)},m=Object(n.useState)(null),u=Object(i.a)(m,2),d=u[0],p=u[1],f=Object(n.useState)({}),g=Object(i.a)(f,2),E=g[0],h=g[1];return l.a.createElement("div",null,l.a.createElement("ul",{id:"side-nav-phone"},l.a.createElement(c.b,{to:"/user/"},l.a.createElement("li",null,l.a.createElement("i",{class:"material-icons"},"store"))),l.a.createElement(c.b,{to:"/user/explore"},l.a.createElement("li",null,l.a.createElement("i",{class:"material-icons"},"explore"))),l.a.createElement(c.b,{to:"/user/notifications"},l.a.createElement("li",null,l.a.createElement("i",{class:"material-icons"},"notifications"))),l.a.createElement(c.b,{to:"/user/messages"},l.a.createElement("li",null,l.a.createElement("i",{class:"material-icons"},"message")))),l.a.createElement("button",{id:"tweet-button-phone",onClick:s},l.a.createElement("i",{class:"material-icons"}," edit")),l.a.createElement("ul",{id:"side-nav"},l.a.createElement(c.b,{to:"/user/"},l.a.createElement("li",null,l.a.createElement("h2",null,"InstaChat"))),l.a.createElement(c.b,{to:"/user/"},l.a.createElement("li",null,l.a.createElement("i",{class:"material-icons"},"store"),"\u2003Home")),l.a.createElement(c.b,{to:"/user/explore"},l.a.createElement("li",null,l.a.createElement("i",{class:"material-icons"},"explore"),"\u2003Explore")),l.a.createElement(c.b,{to:"/user/notifications"},l.a.createElement("li",null,l.a.createElement("i",{class:"material-icons"},"notifications"),"\u2003Notifications")),l.a.createElement(c.b,{to:"/user/messages"},l.a.createElement("li",null,l.a.createElement("i",{class:"material-icons"},"message"),"\u2003Messages")),l.a.createElement(c.b,{to:"/user/profile/"+localStorage.getItem("username")},l.a.createElement("li",null,l.a.createElement("i",{class:"material-icons"},"account_circle"),"\u2003Profile")),l.a.createElement("button",{onClick:s},"Tweet")),l.a.createElement(w,Object.assign({},e,{setFormData:h,formData:E,handleCloseCreatePostOrComment:function(){h({}),o(!1)},setGif:p,ShowCreatePostOrComment:r,gif:d})))},k=a(69),C=a.n(k),I=a(124),x=a(68);var B=function(e){var t=function(e,t){e.preventDefault(),e.target.style.color="#063c5e"===e.target.style.color?"gray":"#063c5e",fetch("/users/posts/"+t,{method:"post",body:JSON.stringify({token:localStorage.getItem("token"),post_id:e.target.id}),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){"success"===e.saved&&console.log("done")}))};return l.a.createElement("div",{id:"home-posts"},"home"===e.type?window.matchMedia("(max-width: 480px)").matches?l.a.createElement("div",{id:"home-profile-div"},l.a.createElement("img",{src:localStorage.getItem("imageUri"),alt:"profile pic",onClick:function(){return e.history.push("/user/profile/"+localStorage.getItem("username"))}}),l.a.createElement("p",null,l.a.createElement("strong",null," Home"))):l.a.createElement("h2",null,"Home"):"",l.a.createElement("div",{id:"home"===e.type?"home-div-posts":""},void 0!==e.posts&&e.posts.length>0?e.posts.map((function(a){return l.a.createElement("div",{key:a._id,className:"user_posts"},l.a.createElement("img",{src:"user"!==e.type?a.user_imageUri:localStorage.getItem("imageUri"),alt:"pic",id:"user-post-img"}),l.a.createElement("div",{id:"post_detail"},l.a.createElement("p",{id:"post-user-detail"},l.a.createElement("strong",null,"user"!==e.type?a.name:localStorage.getItem("f_name")+" "+localStorage.getItem("l_name")),"\u2002",l.a.createElement("span",null,"user"!==e.type?a.username:"@"+e.id," \xb7 ",new Date(a.date).toLocaleDateString("en-us",{day:"numeric",month:"short"}))),l.a.createElement("div",{onClick:"comment"!==e.type?function(){return e.history.push("/user/post/"+a._id)}:""},a.postText,l.a.createElement("br",null),a.postImg&&l.a.createElement("img",{src:a.postImg,alt:"",id:"post-detail-img"}),a.postGif&&l.a.createElement("div",{id:"post-detail-gif-div"},l.a.createElement("img",{src:a.postGif,alt:""}))),l.a.createElement("div",{id:"like-share"},l.a.createElement("span",{onClick:function(e){return t(e,"like")}},l.a.createElement("i",{className:"material-icons",id:a._id,style:{color:-1===a.likes.indexOf(localStorage.getItem("id"))?"gray":"#063c5e"}},"thumb_up")," ","\u2002",a.likes.length),"comment"!==e.type?l.a.createElement("span",{onClick:function(e){return t(e,"share")}},l.a.createElement("i",{className:"material-icons",id:a._id,style:{color:-1===a.shares.indexOf(localStorage.getItem("id"))?"gray":"#063c5e"}}," ","share")," ","\u2002",a.shares.length):"",l.a.createElement("span",null,l.a.createElement("i",{className:"material-icons",onClick:e.handleShowCreateComment,id:a._id}," ","message")," ","\u2002","comment"!==e.type?a.comments.length:a.sub_comments.length))))})):"home"===e.type?l.a.createElement("h2",null,"No Posts to show... ",l.a.createElement("br",null),"Please follow some peoples..."):"",l.a.createElement(w,Object.assign({},e,{setFormData:e.setFormData,formData:e.formData,handleCloseCreatePostOrComment:e.handleCloseCreatePostOrComment,setGif:e.setGif,ShowCreatePostOrComment:e.ShowCreatePostOrComment,gif:e.gif,type:"commentOnComment",postId:e.postId}))))};var _=function(e){var t=Object(f.g)().id,a=Object(f.f)(),r=Object(n.useState)(""),o=Object(i.a)(r,2),c=o[0],s=o[1],d=Object(n.useState)({}),p=Object(i.a)(d,2),g=p[0],E=p[1];Object(n.useEffect)((function(){_()}),[t]);var h=Object(n.useState)(!1),b=Object(i.a)(h,2),y=b[0],v=b[1],j=Object(n.useState)(null),O=Object(i.a)(j,2),w=O[0],S=O[1],k=Object(n.useState)({}),C=Object(i.a)(k,2),I=C[0],x=C[1],_=function(){fetch("/users/profile/"+t+"/posts",{method:"post",body:JSON.stringify({token:localStorage.getItem("token")}),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then(function(){var e=Object(u.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("success"!==t.saved){e.next=3;break}return e.next=3,E(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return l.a.createElement(B,Object.assign({},e,{type:"user",history:a,posts:g.posts,setPosts:E,setFormData:x,formData:I,handleCloseCreatePostOrComment:function(){x({}),v(!1)},setGif:S,ShowCreatePostOrComment:y,gif:w,postId:c,handleShowCreateComment:function(e){s(e.target.id),v(!0)},id:t}))};var N=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),r=a[0],o=a[1],c=function(){return o(!1)},s=Object(n.useState)(!1),g=Object(i.a)(s,2),E=g[0],w=g[1],S=function(){return w(!1)},k=function(){return w(!0)},B=Object(n.useState)(!1),N=Object(i.a)(B,2),D=N[0],F=N[1],L=function(){return F(!1)},P=function(){return F(!0)},T=Object(n.useState)({}),G=Object(i.a)(T,2),H=G[0],U=G[1],M=Object(n.useState)({f_name:"",l_name:"",bio:"",location:"",username:""}),A=Object(i.a)(M,2),J=A[0],q=A[1],z=Object(f.g)().id;Object(n.useEffect)((function(){W()}),[z]);var W=function(){fetch("/users/profile/",{method:"POST",body:JSON.stringify({token:localStorage.getItem("token"),username:"@"+z}),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then(function(){var e=Object(u.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(t.details);case 2:localStorage.setItem("f_name",t.details.f_name),localStorage.setItem("l_name",t.details.l_name),localStorage.setItem("imageUri",t.details.imageUri),null!==document.querySelector(".follow-button")&&(document.querySelector(".follow-button").innerHTML=-1===t.details.followers.indexOf(t.id)?"Follow":"Unfollow");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},Y=Object(f.f)(),R=function(e){var t=document.getElementById("edit-alert");if(t.style.display="block",e.error&&(t.innerHTML+=e.error.msg),e.errors){var a=1;e.errors.map((function(e){t.innerHTML+="<p>"+a+". "+e.msg+"<br/></p>",a++}))}setTimeout((function(){t.style.display="none"}),1e4)},K=function(e,t){e.preventDefault(),document.getElementById("upload-"+t+"-button").disabled=!0,document.getElementById(t+"-upload-spinner").style.display="inline-block";var a=e.target[0].files[0],n=new FormData;n.append("image",a);var l={method:"post",body:n,headers:{token:localStorage.getItem("token")}};fetch("/users/profile/upload/"+t,l).then((function(e){return e.json()})).then((function(e){"success"===e.saved&&("profile"===t?S():L(),W())}))},Z=function(e,t){document.getElementById(t+"-pic-upload").className="custom-file-input "+("image/png"===e.target.files[0].type||"image/jpeg"===e.target.files[0].type?"is-valid":"is-invalid"),document.getElementById(t+"-pic-upload-label").innerHTML=e.target.files[0].name,document.getElementById("upload-"+t+"-button").disabled="is-valid"!==document.getElementById(t+"-pic-upload").className.split(" ")[1]};return l.a.createElement("div",null,l.a.createElement("div",{id:"profile-head"},l.a.createElement("strong",null,H.f_name+" "+H.l_name),l.a.createElement("br",null),H.posts&&H.posts.length," Tweets"),l.a.createElement("div",{id:"body"},""===H.coverImageUri?l.a.createElement("div",{id:"cover-image",onClick:localStorage.getItem("username")===z?P:""}):l.a.createElement("img",{id:"cover-image",src:H.coverImageUri,alt:"cover",onClick:localStorage.getItem("username")===z?P:""}),""===H.imageUri?l.a.createElement("img",{src:C.a,alt:"no profile",id:"profile-pic",onClick:localStorage.getItem("username")===z?k:""}):l.a.createElement("img",{src:H.imageUri,alt:"profile",id:"profile-pic",onClick:localStorage.getItem("username")===z?k:""}),l.a.createElement("div",{id:"profile-div"},l.a.createElement("div",{style:{justifySelf:"right",padding:"0",alignItems:"center"}},localStorage.getItem("username")===z?l.a.createElement("button",{id:"button",className:"edit-button",onClick:function(){return o(!0)}},"Edit Profile"):l.a.createElement("button",{id:"button",className:"follow-button",onClick:function(e){e.preventDefault(),fetch("/users/profile/"+z+"/follow",{method:"post",body:JSON.stringify({token:localStorage.getItem("token")}),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){"success"===e.saved&&W()}))}},"Follow")),l.a.createElement("div",null,"\xa0",l.a.createElement("strong",null,H.f_name+" "+H.l_name),l.a.createElement("br",null),"\xa0",l.a.createElement("span",null,H.username)),l.a.createElement("div",null,H.bio),l.a.createElement("div",null,l.a.createElement("span",null,l.a.createElement("i",{class:"material-icons"},"location_on"),H.location+" ","\xa0",l.a.createElement("i",{class:"material-icons"}," date_range")," "," Joined "+new Date(H.join_date).toLocaleDateString("en-US",{month:"long",year:"numeric"}))),l.a.createElement("div",null,"\xa0",l.a.createElement("strong",null,(void 0===H.following?0:H.following.length)+" ")," ",l.a.createElement("span",null,"Following"),"\u2003",l.a.createElement("strong",null," "+(void 0===H.followers?0:H.followers.length)+" "),l.a.createElement("span",null,"Followers")),l.a.createElement("div",{style:{justifySelf:"center",padding:"0"}},l.a.createElement("strong",null,"Tweets")," ")),l.a.createElement("div",null,l.a.createElement(_,null)),l.a.createElement(h.a,Object.assign({show:r,onHide:c},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0,backdrop:"static",keyboard:!1}),l.a.createElement(h.a.Header,{closeButton:""!==H.username},l.a.createElement(h.a.Title,null,"Edit Profile")),l.a.createElement(h.a.Body,null,l.a.createElement(b.a,{variant:"danger",style:{display:"none"},id:"edit-alert"}),l.a.createElement(y.a,{onChange:function(e){var t=e.target.name,a=e.target.value;q(Object(p.a)({},J,Object(d.a)({},t,a)))},onSubmit:function(e){e.preventDefault();var t=Object(p.a)({},J,{token:localStorage.getItem("token")});fetch("/users/update",{method:"Post",body:JSON.stringify(t),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){if("success"===e.saved){var t=document.getElementById("edit-alert");t.className="fade alert alert-success show",t.style.display="block",t.innerHTML="Your details had been saved...",z=J.username,localStorage.setItem("username",J.username),setTimeout((function(){c()}),2e3),Y.push("/user/profile/"+z)}else R(e)}))}},l.a.createElement(I.a,null,l.a.createElement(x.a,null,l.a.createElement(y.a.Group,{controlId:"formBasicFirstName"},l.a.createElement(y.a.Label,null,"First Name"),l.a.createElement(y.a.Control,{type:"text",placeholder:"Enter First Name",name:"f_name",required:!0}))),l.a.createElement(x.a,null,l.a.createElement(y.a.Group,{controlId:"formBasicLastName"},l.a.createElement(y.a.Label,null,"Last Name"),l.a.createElement(y.a.Control,{type:"text",placeholder:"Enter Last Name",name:"l_name",required:!0})))),l.a.createElement(y.a.Group,{controlId:"formBasicUsername"},l.a.createElement(y.a.Label,null,"Username"),l.a.createElement(y.a.Control,{type:"text",placeholder:"Enter Username",name:"username",required:!0})),l.a.createElement(y.a.Group,{controlId:"formBasicBio"},l.a.createElement(y.a.Label,null,"Bio"),l.a.createElement(y.a.Control,{type:"bio",placeholder:"Add Your Bio",name:"bio",required:!0})),l.a.createElement(y.a.Group,{controlId:"formBasicLocation"},l.a.createElement(y.a.Label,null,"Location"),l.a.createElement(y.a.Control,{type:"text",placeholder:"Add Your location",name:"location",required:!0})),l.a.createElement(j.a,{variant:"primary",type:"submit",id:"login-button"},"Save")))),l.a.createElement(h.a,Object.assign({show:E,onHide:S},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0,backdrop:"static"}),l.a.createElement(h.a.Header,{closeButton:!0},l.a.createElement(h.a.Title,null,"Update Profile Pic")),l.a.createElement(h.a.Body,null,l.a.createElement(y.a,{onSubmit:function(e){return K(e,"profile")}},l.a.createElement(v.a,null,l.a.createElement(y.a.File,{id:"profile-pic-upload",custom:!0},l.a.createElement(y.a.File.Input,{onChange:function(e){return Z(e,"profile")}}),l.a.createElement(y.a.File.Label,{"data-browse":"Browse",id:"profile-pic-upload-label"},"Choose Your Pic"),l.a.createElement(y.a.Control.Feedback,{type:"invalid"},"wrong file format (only .jpg and .png allowed)"))),l.a.createElement(j.a,{variant:"primary",type:"submit",id:"upload-profile-button",disabled:!0},"Upload"),"\u2003",l.a.createElement(O.a,{animation:"border",variant:"primary",size:"sm",id:"profile-upload-spinner",style:{display:"none"}})))),l.a.createElement(h.a,Object.assign({show:D,onHide:L},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0,backdrop:"static"}),l.a.createElement(h.a.Header,{closeButton:!0},l.a.createElement(h.a.Title,null,"Update Profile Cover")),l.a.createElement(h.a.Body,null,l.a.createElement(y.a,{onSubmit:function(e){return K(e,"profile-cover")}},l.a.createElement(v.a,null,l.a.createElement(y.a.File,{id:"profile-cover-pic-upload",custom:!0},l.a.createElement(y.a.File.Input,{onChange:function(e){return Z(e,"profile-cover")}}),l.a.createElement(y.a.File.Label,{"data-browse":"Browse",id:"profile-cover-pic-upload-label"},"Choose Your Pic"),l.a.createElement(y.a.Control.Feedback,{type:"invalid"},"wrong file format (only .jpg and .png allowed)"))),l.a.createElement(j.a,{variant:"primary",type:"submit",id:"upload-profile-cover-button",disabled:!0},"Upload"),"\u2003",l.a.createElement(O.a,{animation:"border",variant:"primary",size:"sm",id:"profile-cover-upload-spinner",style:{display:"none"}}))))))},D=a(24),F=a.n(D);var L=function(e){var t=Object(n.useContext)(q),a=new g.GiphyFetch("tivenjqL1A6W3LpKpPZ4StawMGFAcjdD"),r=Object(n.useState)({}),o=Object(i.a)(r,2),c=o[0],s=o[1],d=Object(n.useState)(!1),p=Object(i.a)(d,2),f=p[0],y=p[1],v=function(){return y(!1)};Object(n.useEffect)((function(){if(Object.keys(t.state).length>0){var e=setInterval((function(){return j()}),2e3);return function(){return clearInterval(e)}}}),[t.state]);var j=function(){fetch("/users/messages",{method:"post",body:JSON.stringify({token:localStorage.getItem("token"),friend_id:t.state.id}),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){"success"===e.saved?(e.length=e.msgs.chat.length,s(e)):s({saved:"unsuccessful"})}))},O=function(e,a){var n=new FormData;n.append(e,a),n.append("friendId",t.state.id),"success"===c.saved?n.append("msgBoxId",c.msgs._id):n.append("msgBoxId",""),fetch("/users/sendMsg",{method:"post",body:n,headers:{token:localStorage.getItem("token")}}).then((function(e){return e.json()})).then((function(t){"success"===t.saved&&("gif"===e&&v(),"text"===e&&(document.getElementById("text").value=""),j())}))},w=function(){var e=Object(u.a)(m.a.mark((function e(t,n){var l,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,a.gif(t.id);case 3:l=e.sent,r=l.data,O("gif",r.images.preview_webp.url);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return l.a.createElement("div",{id:"message-left"},0===Object.keys(t.state).length?l.a.createElement("div",{id:"msg-not-selected"},l.a.createElement("h2",null,"You don't have a message selected"),l.a.createElement("span",null,"Select one of your friend to message")):l.a.createElement("div",{id:"msg-box"},l.a.createElement("div",{id:"msg-box-profile"},l.a.createElement("img",{src:t.state.imageUri,alt:t.state.name+" pic"}),l.a.createElement("div",null,l.a.createElement("strong",null,t.state.name),l.a.createElement("br",null),l.a.createElement("span",null,t.state.username))),l.a.createElement(b.a,{variant:"danger",style:{display:"none"},id:"wrong-image-alert"}),l.a.createElement("div",{id:"msg-box-msgs"},void 0!==c.msgs&&c.msgs.chat.map((function(e){var t="",a=document.getElementById("msg-box-msgs");return a.scrollTop=a.scrollHeight,t=e.senderId===localStorage.getItem("id")?"right":"left",e.text?l.a.createElement("div",{key:e._id,class:t},l.a.createElement("li",null,e.text,"\u2002",l.a.createElement("span",null,F()(e.sent_time).format("HH:mm A")))):e.image?l.a.createElement("div",{key:e._id,class:t},l.a.createElement("img",{src:e.image,alt:""}),l.a.createElement("br",null),l.a.createElement("span",null,F()(e.sent_time).format("HH:mm A"))):l.a.createElement("div",{key:e._id,class:t},l.a.createElement("img",{src:e.gif,alt:""}),l.a.createElement("br",null),l.a.createElement("span",null,F()(e.sent_time).format("HH:mm A")))}))),l.a.createElement("div",{id:"msg-box-bottom-div"},l.a.createElement("i",{className:"material-icons",onClick:function(){return document.getElementById("send-image").click()}},"image"),l.a.createElement("i",{className:"material-icons",onClick:function(){return y(!0)}},"gif"),l.a.createElement("input",{type:"text",placeholder:"Type your msg here... press enter to send",id:"text",onKeyDown:function(e){13===e.keyCode&&O("text",document.getElementById("text").value)}}))),l.a.createElement("input",{type:"file",name:"image",id:"send-image",onChange:function(e){var t=e.target.files[0],a=document.getElementById("wrong-image-alert");"image/jpeg"!==t.type&&"image/png"!==t.type?(a.style.display="block",a.innerHTML="Only .jpeg or .png files allowed...",setInterval((function(){return a.style.display="none"}),2e3),e.target.value=""):O("image",t)},style:{display:"none"}}),l.a.createElement(h.a,Object.assign({show:f,onHide:v},e,{size:"md",centered:!0}),l.a.createElement(h.a.Header,{closeButton:!0},l.a.createElement(h.a.Title,null,"Select Gif")),l.a.createElement(h.a.Body,null,l.a.createElement("div",{id:"gif-modal"},l.a.createElement(E.Grid,{fetchGifs:function(e){return a.emoji({offset:e,limit:10})},width:window.matchMedia("(max-width: 480px)").matches?250:450,columns:window.matchMedia("(max-width: 480px)").matches?2:3,hideAttribution:!0,onGifClick:w})))))};var P=function(e){var t=Object(f.f)(),a=Object(n.useState)([]),r=Object(i.a)(a,2),o=r[0],c=r[1];Object(n.useEffect)((function(){return x()}),[]);var s=Object(n.useState)(""),d=Object(i.a)(s,2),p=d[0],g=d[1],E=Object(n.useState)(!1),h=Object(i.a)(E,2),b=h[0],y=h[1],v=Object(n.useState)(null),j=Object(i.a)(v,2),O=j[0],w=j[1],S=Object(n.useState)({}),k=Object(i.a)(S,2),C=k[0],I=k[1],x=function(){fetch("/users/homePosts",{method:"post",body:JSON.stringify({token:localStorage.getItem("token")}),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then(function(){var e=Object(u.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"success"===t.saved&&(t.details.sort((function(e,t){return new Date(t.sent_time).getSeconds-new Date(e.sent_time).getSeconds})),c(t.details));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return l.a.createElement(B,Object.assign({},e,{type:"home",history:t,posts:o,setPosts:c,setFormData:I,formData:C,handleCloseCreatePostOrComment:function(){I({}),y(!1)},setGif:w,ShowCreatePostOrComment:b,gif:O,postId:p,handleShowCreateComment:function(e){g(e.target.id),y(!0)}}))},T=a(125),G=a(67);var H=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],r=t[1];Object(n.useEffect)((function(){c()}),[]);var o=Object(n.useContext)(q),c=function(){fetch("/users/friend-list",{method:"POst",body:JSON.stringify({token:localStorage.getItem("token")}),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){"success"===e.saved&&r(e.data)}))};return l.a.createElement("div",{id:"messages-right"},l.a.createElement("p",null,l.a.createElement("strong",null,"Messages")," "),l.a.createElement("div",{id:"msg-people-search"},l.a.createElement(T.a,{className:"mb-3"},l.a.createElement(T.a.Prepend,null,l.a.createElement(T.a.Text,null,l.a.createElement("i",{className:"material-icons"},"\ue8b6"))),l.a.createElement(G.a,{placeholder:"Search your Friends"}))),a.map((function(e){return l.a.createElement("div",{key:e.id,id:"msg-profile-pic",onClick:function(){return o.dispatch({type:"change",payload:e})}},l.a.createElement("img",{src:e.imageUri,alt:e.name+" pic"}),l.a.createElement("div",null,e.name,l.a.createElement("br",null),e.username))})))};var U=function(e){var t=Object(f.g)().id,a=Object(n.useState)(""),r=Object(i.a)(a,2),o=(r[0],r[1]),c=Object(n.useState)({}),s=Object(i.a)(c,2),m=s[0],u=s[1];Object(n.useEffect)((function(){return z()}),[]);var d=Object(n.useState)(!1),p=Object(i.a)(d,2),g=p[0],E=p[1],h=Object(n.useState)(null),b=Object(i.a)(h,2),y=b[0],v=b[1],j=Object(n.useState)({}),O=Object(i.a)(j,2),S=O[0],k=O[1],C=Object(n.useState)(null),I=Object(i.a)(C,2),x=I[0],_=I[1],N=Object(n.useState)({}),D=Object(i.a)(N,2),L=D[0],P=D[1],T=Object(n.useState)(""),G=Object(i.a)(T,2),H=G[0],U=G[1],M=Object(n.useState)(!1),A=Object(i.a)(M,2),J=A[0],q=A[1],z=function(){fetch("/users/post/"+t,{method:"get",headers:{token:localStorage.getItem("token")}}).then((function(e){return e.json()})).then((function(e){console.log(e),"success"===e.saved&&(u(e.details),console.log(e.details))}))},W=function(e,a){e.preventDefault();var n=e.target;fetch("/users/posts/"+a,{method:"post",body:JSON.stringify({token:localStorage.getItem("token"),post_id:t}),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){"success"===e.saved&&(console.log("done"),n.style.color="blue"===n.style.color?"gray":"blue")}))};return Object.keys(m).length>0&&l.a.createElement("div",null,l.a.createElement("div",{id:"single-post-head"},l.a.createElement("h3",null,l.a.createElement("strong",null,"Post"))),l.a.createElement("div",{id:"single-post-profile"},l.a.createElement("img",{src:m.imageUri,alt:m.name+" profile pic"}),l.a.createElement("div",null,l.a.createElement("strong",null,m.name),l.a.createElement("br",null),l.a.createElement("span",null,m.username))),l.a.createElement("div",null,l.a.createElement("div",{id:"single-post-detail"},m.postText),l.a.createElement("div",{id:"single-post-date"},l.a.createElement("span",null,F()(m.date).format("HH:mm A")+" \xb7 "+F()(m.date).format("ll"))),l.a.createElement("div",{id:"single-post-likeshare"},l.a.createElement("strong",null,m.likes.length),l.a.createElement("span",null," Likes")," \u2003",l.a.createElement("strong",null,m.shares.length),l.a.createElement("span",null," Shares")),l.a.createElement("div",{id:"likesharecomment"},l.a.createElement("span",{onClick:function(e){return W(e,"like")},style:{color:-1===m.likes.indexOf(localStorage.getItem("id"))?"gray":"blue"}},l.a.createElement("i",{className:"material-icons"},"thumb_up"),"\u2002 Like"),l.a.createElement("span",{onClick:function(e){return W(e,"share")},style:{color:-1===m.shares.indexOf(localStorage.getItem("id"))?"gray":"blue"}},l.a.createElement("i",{className:"material-icons"}," share"),"\u2002 Share"),l.a.createElement("span",null,l.a.createElement("i",{className:"material-icons",onClick:function(e){o(e.target.id),E(!0)}}," ","message"),"\u2002 Comment"))),l.a.createElement(B,Object.assign({},e,{type:"comment",posts:m.comments,setFormData:P,formData:L,handleCloseCreatePostOrComment:function(){P({}),q(!1)},setGif:_,ShowCreatePostOrComment:J,gif:x,postId:H,handleShowCreateComment:function(e){U(e.target.id),q(!0)}})),l.a.createElement(w,Object.assign({},e,{setFormData:k,formData:S,handleCloseCreatePostOrComment:function(){k({}),E(!1)},setGif:v,ShowCreatePostOrComment:g,gif:y,type:"comment",postId:t})))};var M=function(){var e=Object(n.useContext)(q);return l.a.createElement("div",{class:"main-left"},l.a.createElement(f.c,null,l.a.createElement(f.a,{path:"/user/",exact:!0,component:P}),l.a.createElement(f.a,{path:"/user/profile/:id",component:N}),l.a.createElement(f.a,{path:"/user/messages",component:window.matchMedia("(max-width: 480px)").matches?Object.keys(e.state).length>0?L:H:L}),l.a.createElement(f.a,{path:"/user/post/:id",component:U})))};var A=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],r=t[1];return l.a.createElement("div",{className:"profile-side-bar"},l.a.createElement("form",{onChange:function(e){document.getElementById("search-people-results").style.display="block";var t=e.target.value;""!==t?fetch("/users/search",{method:"post",body:JSON.stringify({value:t}),headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then(function(){var e=Object(u.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):document.getElementById("search-people-results").style.display="none"}},l.a.createElement(T.a,{className:"mb-3"},l.a.createElement(T.a.Prepend,null,l.a.createElement(T.a.Text,null,l.a.createElement("i",{className:"material-icons"},"\ue8b6"))),l.a.createElement(G.a,{placeholder:"Search your Friends",name:"search"})),l.a.createElement("ul",{id:"search-people-results"},a.map((function(e){return l.a.createElement(c.b,{to:"/user/profile/"+e.username.split("@")[1]},l.a.createElement("li",null,l.a.createElement("img",{src:e.imageUri,alt:"profile"}),l.a.createElement("div",null,e.f_name+" "+e.l_name," ",l.a.createElement("br",null),e.username)))})))))};var J=function(){return l.a.createElement("div",{className:"main-right"},l.a.createElement(f.c,null,l.a.createElement(f.a,{path:"/user/profile/:id",component:A}),l.a.createElement(f.a,{path:"/user/messages",component:H})))},q=l.a.createContext();var z=function(){var e=Object(n.useReducer)((function(e,t){switch(t.type){case"change":return t.payload;default:return e}}),{}),t=Object(i.a)(e,2),a=t[0],r=t[1];return l.a.createElement("div",{id:"main"},l.a.createElement(q.Provider,{value:{state:a,dispatch:r}},l.a.createElement(M,null),l.a.createElement(J,null)))};var W=function(){return l.a.createElement("div",{id:"user"},l.a.createElement(z,null),l.a.createElement(S,null))};var Y=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),r=a[0],o=a[1],c=function(){o(!0),N()},s=Object(n.useState)(!1),m=Object(i.a)(s,2),u=m[0],g=m[1],E=function(){return g(!1)},v=Object(n.useState)({email:"",password:"",method:"native"}),O=Object(i.a)(v,2),w=O[0],S=O[1],k=Object(n.useState)({f_name:"",l_name:"",email:"",password:"",method:"native",imageUri:""}),C=Object(i.a)(k,2),B=C[0],_=C[1],N=function(){var e=document.createElement("script");e.async=!0,e.defer=!0,e.crossorigin="anonymous",e.src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v6.0&appId=593870491214414&autoLogAppEvents=1",document.head.appendChild(e),F()},D=Object(n.useRef)(),F=function(){var e=document.createElement("script");e.src="https://apis.google.com/js/platform.js?onload=googleSDKLoaded",e.async=!0,e.defer=!0,document.head.appendChild(e),window.googleSDKLoaded=function(){window.gapi.load("auth2",(function(){window.auth2=window.gapi.auth2.init({client_id:"696463816448-rsbv7ci8el2kmd18q582li2832bbuvpl.apps.googleusercontent.com",cookiepolicy:"single_host_origin",scope:"profile email"}),function(){var e=D.current.attributes[0].value;window.auth2.attachClickHandler(D.current,{},(function(t){var a=t.getBasicProfile();"register"===e?(_({f_name:a.getGivenName(),l_name:a.getFamilyName(),email:a.getEmail(),imageUri:a.getImageUrl(),method:"google"}),document.getElementById("register-button").click()):(S({email:a.getEmail(),method:"google",password:"no"}),document.getElementById("login-button").click())}),(function(e){alert(JSON.stringify(e,void 0,2))}))}()}))}},L=function(e,t){var a=document.getElementById(t);if(a.style.display="block",e.error&&(a.innerHTML+=e.error.msg),e.errors){var n=1;e.errors.map((function(e){a.innerHTML+="<p>"+n+". "+e.msg+"<br/></p>",n++}))}setTimeout((function(){a.style.display="none"}),1e4)},P=Object(f.f)(),T=function(e,t){e.preventDefault(),window.FB.login((function(e){"connected"===e.status&&window.FB.api("/me?fields=email"+("register"===t?",first_name,last_name,picture":""),(function(e){"login"===t?(S({email:e.email,method:"facebook",password:"no"}),document.getElementById("login-button").click()):(console.log(e),_({f_name:e.first_name,l_name:e.last_name,email:e.email,imageUri:e.picture.data.url,method:"facebook"}),document.getElementById("register-button").click())}))}),{scope:"public_profile,email"})};return l.a.createElement("div",{id:"home"},l.a.createElement("div",null,"Welcome To InstaChat"),l.a.createElement("div",null,l.a.createElement("button",{onClick:c},"Login"),l.a.createElement("button",{onClick:function(){g(!0),N()}},"Sign Up")),l.a.createElement(h.a,Object.assign({show:r,onHide:function(){return o(!1)}},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),l.a.createElement(h.a.Header,{closeButton:!0},l.a.createElement(h.a.Title,null,"Login")),l.a.createElement(h.a.Body,null,l.a.createElement(b.a,{variant:"danger",style:{display:"none"},id:"login-alert"}),l.a.createElement(y.a,{onSubmit:function(e){e.preventDefault();var t=Object(p.a)({},w);fetch("/users/login/",{method:"POST",body:JSON.stringify(t),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){return e.json()})).then((function(e){"success"===e.saved?(console.log(e),localStorage.setItem("token",e.token),localStorage.setItem("id",e._id),localStorage.setItem("username",e.username),localStorage.setItem("f_name",e.f_name),localStorage.setItem("l_name",e.l_name),localStorage.setItem("imageUri",e.imageUri),P.push("/user/profile/"+e.username)):L(e,"login-alert")}))},onChange:function(e){var t=e.target.name,a=e.target.value;S(Object(p.a)({},w,Object(d.a)({},t,a)))}},l.a.createElement(y.a.Group,{controlId:"formBasicEmail"},l.a.createElement(y.a.Label,null,"Email address"),l.a.createElement(y.a.Control,{type:"email",placeholder:"Enter email",name:"email"})),l.a.createElement(y.a.Group,{controlId:"formBasicPassword"},l.a.createElement(y.a.Label,null,"Password"),l.a.createElement(y.a.Control,{type:"password",placeholder:"Password",name:"password"})),l.a.createElement(j.a,{variant:"primary",type:"submit",id:"login-button"},"Login"))),l.a.createElement(h.a.Footer,null,l.a.createElement(j.a,{ref:D,button_type:"login"},"Login with Google"),l.a.createElement(j.a,{onClick:function(e){return T(e,"login")}},"Login with FaceBook"))),l.a.createElement(h.a,Object.assign({show:u,onHide:E},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),l.a.createElement(h.a.Header,{closeButton:!0},l.a.createElement(h.a.Title,null,"Register")),l.a.createElement(h.a.Body,null,l.a.createElement(b.a,{id:"register-alert",variant:"danger",style:{display:"none"}}),l.a.createElement(y.a,{onSubmit:function(e){e.preventDefault();var t=Object(p.a)({},B);fetch("/users/register/",{method:"POST",body:JSON.stringify(t),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){return e.json()})).then((function(e){if("success"===e.saved){var t=document.getElementById("register-alert");t.className="fade alert alert-success show",t.style.display="block",t.innerHTML="Registration Successful...\nProceed to Login.",setTimeout((function(){E(),c()}),2e3)}else L(e,"register-alert")}))},onChange:function(e){var t=e.target.name,a=e.target.value;_(Object(p.a)({},B,Object(d.a)({},t,a)))}},l.a.createElement(I.a,null,l.a.createElement(x.a,null,l.a.createElement(y.a.Group,{controlId:"formBasicEmail"},l.a.createElement(y.a.Label,null,"First Name"),l.a.createElement(y.a.Control,{type:"text",placeholder:"First Name",name:"f_name",value:B.f_name,required:!0}))),l.a.createElement(x.a,null,l.a.createElement(y.a.Group,{controlId:"formBasicEmail"},l.a.createElement(y.a.Label,null,"Last Name"),l.a.createElement(y.a.Control,{type:"text",placeholder:"Last Name",name:"l_name",value:B.l_name,required:!0})))),l.a.createElement(y.a.Group,{controlId:"formBasicEmail"},l.a.createElement(y.a.Label,null,"Email address"),l.a.createElement(y.a.Control,{type:"email",placeholder:"Enter email",name:"email",value:B.email,required:!0})),l.a.createElement(y.a.Group,{controlId:"formBasicPassword"},l.a.createElement(y.a.Label,null,"Password"),l.a.createElement(y.a.Control,{type:"password",placeholder:"Password",name:"password",value:B.password})),l.a.createElement(j.a,{variant:"primary",type:"submit",id:"register-button"},"Sign Up"))),l.a.createElement(h.a.Footer,null,l.a.createElement(j.a,{ref:D,button_type:"register"},"SignUp with Google"),l.a.createElement(j.a,{onClick:function(e){return T(e,"register")}},"SignUp with FaceBook"))))};var R=function(){return l.a.createElement("div",{className:"App"},l.a.createElement(c.a,null,l.a.createElement(f.c,null,l.a.createElement(f.a,{path:"/login",exact:!0,component:Y}),l.a.createElement(f.a,{path:"/user/",component:W}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(R,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},69:function(e,t,a){e.exports=a.p+"static/media/avtar.1e976c46.png"},71:function(e,t,a){e.exports=a(118)},76:function(e,t,a){},97:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=97}},[[71,1,2]]]);
//# sourceMappingURL=main.db0ba86d.chunk.js.map